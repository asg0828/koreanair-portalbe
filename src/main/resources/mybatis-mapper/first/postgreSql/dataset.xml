<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.bdp.ap.app.dataset.mapper.DataSetMapper">
	 
	<sql id="where">
		<where>
			coalesce(a.del_yn,'N') = 'N'
			<if test="dataDivCd != null and dataDivCd != 'ALL'">
				AND a.data_div_cd=#{dataDivCd}
			</if>			 
			<if test="sptGrpCd != null and sptGrpCd != 'ALL'">
				AND a.spt_grp_cd=#{sptGrpCd}
			</if>
			<if test="sptCompCd != null and sptCompCd != 'ALL'">
				AND a.spt_comp_cd=#{sptCompCd}
			</if>
			<if test="bizDivCd != null and bizDivCd != 'ALL'">
				AND a.biz_div_cd=#{bizDivCd}
			</if>
			<if test="lvlDivCd != null and lvlDivCd != 'ALL'">
				AND a.lvl_div_cd=#{lvlDivCd}
			</if>

			<if test="tblKor != null and tblKor != ''">
				<bind
						name="tblKor"
						value='@com.bdp.ap.common.EscapeHelper@escape(tblKor)'
				/>
				AND UPPER(a.tbl_kor) LIKE CONCAT('%',UPPER(#{tblKor}),'%')
			</if>
			<if test="tblEng != null and tblEng != ''">
				<bind
						name="tblEng"
						value='@com.bdp.ap.common.EscapeHelper@escape(tblEng)'
				/>
				AND UPPER(a.tbl_eng) LIKE CONCAT('%',UPPER(#{tblEng}),'%')
			</if>
			<if test="tblDesc != null and tblDesc != ''">
				<bind
						name="tblDesc"
						value='@com.bdp.ap.common.EscapeHelper@escape(tblDesc)'
				/>
				AND UPPER(a.tbl_desc) LIKE CONCAT('%',UPPER(#{tblDesc}),'%')
			</if>
		</where>
	</sql>

    <sql id="order">   
	    ORDER BY z.rownum ASC
    </sql>

    <select id="selectStructTableInfoList" resultType="dataSetModel" parameterType="dataSetCriteria">
			select * from (
				select
					  row_number() over(order by a.rgst_dt asc) as rownum
					, a.tbl_info_id
					, a.data_div_cd
					, (select s1.code_nm from t_code s1 where s1.group_id='DATA_DIV_CD' and s1.code_id= a.data_div_cd) as data_div_nm
					, a.tbl_st_cd				
					, a.spt_grp_cd
					, (select s1.code_nm from t_code s1 where s1.group_id='SPT_GRP_CD' and s1.code_id= a.spt_grp_cd) as spt_grp_nm
					, a.biz_div_cd
					, (select s1.code_nm  from t_code s1 where s1.group_id='BIZ_DIV_CD' and s1.code_id= a.biz_div_cd) as biz_div_nm
					, a.lvl_div_cd
					, (select s1.code_nm  from t_code s1 where s1.group_id='LVL_DIV_CD' and s1.code_id= a.lvl_div_cd) as lvl_div_nm
					, a.spt_cyc_cd
					, (select s1.code_nm  from t_code s1 where s1.group_id='SPT_CYC_CD' and s1.code_id= a.spt_cyc_cd) as spt_cyc_nm
					, a.spt_comp_cd
					, (select s1.code_nm  from t_code s1 where s1.group_id='SPT_COMP_CD' and s1.code_id= a.spt_comp_cd) as spt_comp_nm
					, a.tbl_kor					
					, a.tbl_eng
					, a.tbl_desc
					, (select array_to_string(array_agg(s1.tag_nm), ',')
				 		from t_hash_tag s1
						where s1.tbl_info_id = a.tbl_info_id 
						and COALESCE(s1.del_yn,'N') = 'N'
					  )  as hash_tag_nm
					, a.use_prop_cnt
					, a.tbl_view_cnt
				from t_table_info a
				<include refid="where"></include>
				AND a.data_div_cd != '03'
			) z
			<include refid="order"></include>
    </select>

    <select id="selectStructTableInfoListCount" resultType="int" parameterType="dataSetCriteria"> 	 
			select  count(*)				 
			from t_table_info a
			<include refid="where"></include>
			AND a.data_div_cd != '03'		
    </select>
    
    <select id="selectStructTableInfoDetail" resultType="dataSetModel" parameterType="dataSetCriteria">
		     select a.tbl_kor
					,a.tbl_eng
					,a.spt_grp_cd
					,(select s1.code_nm from t_code s1 where s1.group_id='SPT_GRP_CD' and s1.code_id= a.spt_grp_cd) as spt_grp_nm
					,a.preserv_dt
					,a.lvl_div_cd
					,(select s1.code_nm  from t_code s1 where s1.group_id='LVL_DIV_CD' and s1.code_id= a.lvl_div_cd) as lvl_div_nm
					,a.biz_div_cd
					,(select s1.code_nm  from t_code s1 where s1.group_id='BIZ_DIV_CD' and s1.code_id= a.biz_div_cd) as biz_div_nm
					,(select array_to_string(array_agg(s1.hash_tag_id), ',')
						from t_hash_tag s1
						where s1.tbl_info_id = a.tbl_info_id 
						and COALESCE(s1.del_yn,'N') = 'N'
						)  as hash_tag_id
					 ,(select array_to_string(array_agg(s1.tag_nm), ',')
						from t_hash_tag s1
						where s1.tbl_info_id = a.tbl_info_id 
						and COALESCE(s1.del_yn,'N') = 'N'
						)  as hash_tag_nm
					,a.tbl_desc
					, a.DATA_DIV_CD AS DATA_DIV_CD
					, (SELECT S1.CODE_NM FROM T_CODE S1 WHERE S1.GROUP_ID='DATA_DIV_CD' AND S1.CODE_ID= a.DATA_DIV_CD) AS DATA_DIV_NM
					, a.TBL_INFO_ID AS TBL_INFO_ID
					, a.SPT_CYC_CD  AS SPT_CYC_CD
					, (SELECT S1.CODE_NM  FROM T_CODE S1 WHERE S1.GROUP_ID='SPT_CYC_CD' AND S1.CODE_ID= a.SPT_CYC_CD) AS SPT_CYC_NM
					, a.PRESERV_DT  AS PRESERV_DT
					, a.DB_TYP      AS DB_TYP 
			from t_table_info a 
			where a.tbl_info_id =#{tblInfoId}
			and COALESCE(a.del_yn,'N') = 'N'
    </select>
    
    <select id="selectStructColumnInfo" resultType="dataSetModel" parameterType="dataSetCriteria">
    	select a.tbl_info_id		
			,b.col_id 
			,b.col_nm 
			,b.col_ord 
			,b.pk_yn 
			,b.data_typ_nm 
			,b.com_cd 
			,b.col_desc 
		from t_table_info a
		inner join t_column_info b  
		on a.tbl_info_id =b.tbl_info_id 
		and COALESCE(b.del_yn,'N') = 'N'
		where a.tbl_info_id =#{tblInfoId}
		and COALESCE(a.del_yn,'N') = 'N'
		order by b.col_ord
    </select>
    
    
    <select id="selectExtrnlTableInfoList" resultType="dataSetModel" parameterType="dataSetCriteria">
		select * from (
			select
			    row_number() over(order by a.rgst_dt asc) as rownum	
				, a.tbl_info_id		   	
				, a.tbl_st_cd
				, a.data_div_cd
				, (select s1.code_nm from t_code s1 where s1.group_id='DATA_DIV_CD' and s1.code_id= a.data_div_cd) as data_div_nm				
				,a.spt_comp_cd
				,(select s1.code_nm from t_code s1 where s1.group_id='SPT_COMP_CD' and s1.code_id= a.spt_comp_cd) as spt_comp_nm
				,a.biz_div_cd
				,(select s1.code_nm  from t_code s1 where s1.group_id='BIZ_DIV_CD' and s1.code_id= a.biz_div_cd) as biz_div_nm
				,a.lvl_div_cd
				,(select s1.code_nm  from t_code s1 where s1.group_id='LVL_DIV_CD' and s1.code_id= a.lvl_div_cd) as lvl_div_nm
				,a.tbl_kor
				,a.tbl_eng
				,(select array_to_string(array_agg(s1.tag_nm), ',')
					from t_hash_tag s1
					where s1.tbl_info_id = a.tbl_info_id 
					and COALESCE(s1.del_yn,'N') = 'N'
				)  as hash_tag_nm
				,a.use_prop_cnt
				,a.tbl_view_cnt							
			from t_table_info a  
			<include refid="where"></include>
			and a.data_div_cd = '03'			
			) z
	  	<include refid="order"></include>
    </select>
    
    <select id="selectExtrnlTableInfoListCount" resultType="int" parameterType="dataSetCriteria">		
		select count(*)			
		from t_table_info a
		<include refid="where"></include>
		AND a.data_div_cd = '03'  					 
    </select>	
    
    <select id="selectExtrnlTableInfoDetail" resultType="dataSetModel" parameterType="dataSetCriteria">
    	select	a.tbl_info_id
				,a.tbl_kor
				,a.tbl_eng
				,a.db_typ
				,a.spt_grp_cd
				,(select s1.code_nm from t_code s1 where s1.group_id='SPT_GRP_CD' and s1.code_id= a.spt_grp_cd) as spt_grp_nm
				,a.biz_div_cd
				,(select s1.code_nm  from t_code s1 where s1.group_id='BIZ_DIV_CD' and s1.code_id= a.biz_div_cd) as biz_div_nm
				,a.lvl_div_cd
				,(select s1.code_nm  from t_code s1 where s1.group_id='LVL_DIV_CD' and s1.code_id= a.lvl_div_cd) as lvl_div_nm
				,a.spt_cyc_cd 
				,(select s1.code_nm  from t_code s1 where s1.group_id='SPT_CYC_CD' and s1.code_id= a.spt_cyc_cd) as spt_cyc_nm
				,a.spt_comp_cd
				,(select s1.code_nm from t_code s1 where s1.group_id='SPT_COMP_CD' and s1.code_id= a.spt_comp_cd) as spt_comp_nm
				,a.use_term_cd 
				,(select s1.code_nm from t_code s1 where s1.group_id='USE_TERM_CD' and s1.code_id= a.use_term_cd) as use_term_nm
				,a.spt_site_nm 
				,a.spt_site_addr 
				,a.preserv_dt
				,(select array_to_string(array_agg(s1.hash_tag_id), ',')
					from t_hash_tag s1
					where s1.tbl_info_id = a.tbl_info_id 
					and COALESCE(s1.del_yn,'N') = 'N'
				)  as hash_tag_id
				,(select array_to_string(array_agg(s1.tag_nm), ',')
					from t_hash_tag s1
					where s1.tbl_info_id = a.tbl_info_id 
					and COALESCE(s1.del_yn,'N') = 'N'
				)  as hash_tag_nm
				,a.tbl_desc 
		from t_table_info a 
		where a.tbl_info_id =#{tblInfoId}
		and COALESCE(a.del_yn,'N') = 'N'
    </select>
    
    <select id="selectExtrnlColumnInfoDetail" resultType="dataSetModel" parameterType="dataSetCriteria">
    	select a.tbl_info_id				 
				,b.col_id 
				,b.col_nm 
				,b.col_ord 
				,b.data_typ_nm 
				,b.pk_yn 	
		from t_table_info a
		inner t_column_info b 
		on a.tbl_info_id =b.tbl_info_id 
		and COALESCE(b.del_yn,'N') = 'N'
		where a.tbl_info_id =#{tblInfoId}
		and COALESCE(a.del_yn,'N') = 'N'
		order by b.col_ord
    </select>
    
    <update id="addViewCntDataSet" parameterType="String">
		UPDATE
			T_TABLE_INFO
		set
			TBL_VIEW_CNT = (COALESCE(TBL_VIEW_CNT, 0) + 1)
		WHERE
			TBL_INFO_ID = #{tblInfoId}
	</update>
    
    <select id="selectDataComCodeList" resultType="dataSetModel" parameterType="dataSetCriteria">
		select * from (
			select
			    row_number() over(order by a.rgst_dt asc) as rownum
			    ,a.grp_comp_cd  
				,(select s1.code_nm from t_code s1 where s1.group_id='GRP_COMP_CD' and s1.code_id= a.grp_comp_cd) as grp_comp_nm
				,a.tbl_eng_nm 
				,a.tbl_kor_nm 
				,a.col_eng_nm 
				,a.col_kor_nm 
				,a.valid_val 
				,a.valid_nm 
		from t_data_com_code a
		where COALESCE(a.del_yn,'N') = 'N'
		<if test="grpCompCd != null and grpCompCd != ''">
				and a.grp_comp_cd = #{grpCompCd}
		</if>
		<if test="searchKey != '' and searchKey == 'tbl_eng_nm' and searchValue != ''">
				and UPPER(a.tbl_eng_nm) LIKE CONCAT('%',UPPER(#{searchValue}),'%')
		</if>
		<if test="searchKey != '' and searchKey == 'col_eng_nm' and searchValue != ''">
				and UPPER(a.col_eng_nm) LIKE CONCAT('%',UPPER(#{searchValue}),'%')
		</if>		
		) z
	  <include refid="order"></include>
	  <include refid="paging.pagingOffsetSQL" />
    </select>
    
    <select id="selectDataComCodeListCount" resultType="dataSetModel" parameterType="dataSetCriteria">
		
		select count(*) 
		from t_data_com_code a
		where COALESCE(a.del_yn,'N') = 'N'
		<if test="grpCompCd != null and grpCompCd != ''">
				and a.grp_comp_cd = #{grpCompCd}
		</if>
		<if test="searchKey != '' and searchKey == 'tbl_eng_nm' and searchValue != ''">
				and UPPER(a.tbl_eng_nm) LIKE CONCAT('%',UPPER(#{searchValue}),'%')
		</if>
		<if test="searchKey != '' and searchKey == 'col_eng_nm' and searchValue != ''">
				and UPPER(a.col_eng_nm) LIKE CONCAT('%',UPPER(#{searchValue}),'%')
		</if>		
		
    </select>
    
    <select id="selectDataComCodeListExcel" resultType="dataSetModel" parameterType="dataSetCriteria">
		select * from (
			select
			    row_number() over(order by a.rgst_dt asc) as rownum
			    ,a.grp_comp_cd  
				,(select s1.code_nm from t_code s1 where s1.group_id='GRP_COMP_CD' and s1.code_id= a.grp_comp_cd) as grp_comp_nm
				,a.tbl_eng_nm 
				,a.tbl_kor_nm 
				,a.col_eng_nm 
				,a.col_kor_nm 
				,a.valid_val 
				,a.valid_nm 
		from t_data_com_code a
		where COALESCE(a.del_yn,'N') = 'N'
		<if test="grpCompCd != null and grpCompCd != ''">
				and a.grp_comp_cd = #{grpCompCd}
		</if>
		<if test="searchKey != '' and searchKey == 'tbl_eng_nm' and searchValue != ''">
				and UPPER(a.tbl_eng_nm) LIKE CONCAT('%',UPPER(#{searchValue}),'%')
		</if>
		<if test="searchKey != '' and searchKey == 'col_eng_nm' and searchValue != ''">
				and UPPER(a.col_eng_nm) LIKE CONCAT('%',UPPER(#{searchValue}),'%')
		</if>		
		) z
	  <include refid="order"></include> 
    </select>
    
    <select id="selectStandardTermsProposalPopList" resultType="dataSetModel" parameterType="dataSetCriteria">
		select * from (
			select
			    row_number() over(order by a.rgst_dt asc) as rownum
			    ,a.grp_comp_cd 
			        ,(select s1.code_nm from t_code s1 where s1.group_id='GRP_COMP_CD' and s1.code_id= a.grp_comp_cd) as grp_comp_nm 
			        ,a.terms_nm 
			        ,a.terms_eng 
			        ,a.terms_abb 
			from t_standard_terms_proposal a
			where COALESCE(a.del_yn,'N') = 'N'
		<if test="grpCompCd != null and grpCompCd != ''">
				and a.grp_comp_cd = #{grpCompCd}
		</if>
		<if test="searchKey != '' and searchKey == 'terms_nm' and searchValue != ''">
				and UPPER(a.terms_nm) LIKE CONCAT('%',UPPER(#{searchValue}),'%')
		</if>
		<if test="searchKey != '' and searchKey == 'terms_eng' and searchValue != ''">
				and UPPER(a.terms_eng) LIKE CONCAT('%',UPPER(#{searchValue}),'%')
		</if>		
		) z
	  <include refid="order"></include>
	  <include refid="paging.pagingOffsetSQL" />
    </select>
    
    <select id="selectStandardTermsProposalPopListCount" resultType="dataSetModel" parameterType="dataSetCriteria">
		    select count(*)			     
			from t_standard_terms_proposal a
			where COALESCE(a.del_yn,'N') = 'N'
		<if test="grpCompCd != null and grpCompCd != ''">
				and a.grp_comp_cd = #{grpCompCd}
		</if>
		<if test="searchKey != '' and searchKey == 'terms_nm' and searchValue != ''">
				and UPPER(a.terms_nm) LIKE CONCAT('%',UPPER(#{searchValue}),'%')
		</if>
		<if test="searchKey != '' and searchKey == 'terms_eng' and searchValue != ''">
				and UPPER(a.terms_eng) LIKE CONCAT('%',UPPER(#{searchValue}),'%')
		</if>
    </select>
    
    <select id="selectStandardTermsProposalPopListExcel" resultType="dataSetModel" parameterType="dataSetCriteria">
		select * from (
			select
			    row_number() over(order by a.rgst_dt asc) as rownum
			    ,a.grp_comp_cd 
			        ,(select s1.code_nm from t_code s1 where s1.group_id='GRP_COMP_CD' and s1.code_id= a.grp_comp_cd) as grp_comp_nm 
			        ,a.terms_nm 
			        ,a.terms_eng 
			        ,a.terms_abb 
			from t_standard_terms_proposal a
			where COALESCE(a.del_yn,'N') = 'N'
		<if test="grpCompCd != null and grpCompCd != ''">
				and a.grp_comp_cd = #{grpCompCd}
		</if>
		<if test="searchKey != '' and searchKey == 'terms_nm' and searchValue != ''">
				and UPPER(a.terms_nm) LIKE CONCAT('%',UPPER(#{searchValue}),'%')
		</if>
		<if test="searchKey != '' and searchKey == 'terms_eng' and searchValue != ''">
				and UPPER(a.terms_eng) LIKE CONCAT('%',UPPER(#{searchValue}),'%')
		</if>		
		) z
	  <include refid="order"></include> 
    </select>
    
    
    <select id="selectStandardTermsProposalList" resultType="dataSetModel" parameterType="dataSetCriteria">
		select * from (
			select
			    row_number() over(order by a.rgst_dt asc) as rownum
				,a.grp_comp_cd 
		        ,(select s1.code_nm from t_code s1 where s1.group_id='GRP_COMP_CD' and s1.code_id= a.grp_comp_cd) as grp_comp_nm 
		        ,a.terms_nm 
		        ,a.terms_eng 
		        ,a.terms_abb 
		        ,a.detail_desc 
		        ,a.rgst_id 
		        ,(select s2.user_nm  from t_user s2 where s2.user_id = a.rgst_id) as rgst_nm 
		        ,a.rgst_dt 
		        ,a.modi_id 
		        ,(select s2.user_nm  from t_user s2 where s2.user_id = a.modi_id) as modi_nm
		        ,a.modi_dt 
		        ,a.view_cnt 
			from t_standard_terms_proposal a
			where COALESCE(a.del_yn,'N') = 'N'
	 		<if test="searchKey != '' and searchKey == 'terms_nm' and searchValue != ''">
					and UPPER(a.terms_nm) LIKE CONCAT('%',UPPER(#{searchValue}),'%')
			</if>
			<if test="searchKey != '' and searchKey == 'terms_eng' and searchValue != ''">
					and UPPER(a.terms_eng) LIKE CONCAT('%',UPPER(#{searchValue}),'%')
			</if>		
		) z
	  <include refid="order"></include>
	  <include refid="paging.pagingOffsetSQL" />
    </select>
    
    <select id="selectStandardTermsProposalListCount" resultType="dataSetModel" parameterType="dataSetCriteria">
			select count(*)			     
			from t_standard_terms_proposal a
			where COALESCE(a.del_yn,'N') = 'N'
	 		<if test="searchKey != '' and searchKey == 'terms_nm' and searchValue != ''">
					and UPPER(a.terms_nm) LIKE CONCAT('%',UPPER(#{searchValue}),'%')
			</if>
			<if test="searchKey != '' and searchKey == 'terms_eng' and searchValue != ''">
					and UPPER(a.terms_eng) LIKE CONCAT('%',UPPER(#{searchValue}),'%')
			</if>		
		
    </select>
    
    <select id="selectStandardTermsProposalDetail" resultType="dataSetModel" parameterType="dataSetCriteria">
    	select a.grp_comp_cd
		         ,a.terms_nm 
		        ,a.terms_eng 
		        ,a.terms_abb 
		         ,a.rgst_id 
		        ,(select s2.user_nm  from t_user s2 where s2.user_id = a.rgst_id) as rgst_nm 
		        ,a.detail_desc 
		        ,a.first_appr_id 
		        ,(select s2.user_nm  from t_user s2 where s2.user_id = a.first_appr_id) as first_appr_nm
		        ,a.second_appr_id 
		        ,(select s2.user_nm  from t_user s2 where s2.user_id = a.second_appr_id) as second_appr_nm
		        ,a.drafter_id 
		        ,(select s2.user_nm  from t_user s2 where s2.user_id = a.drafter_id) as drafter_nm
		from t_standard_terms_proposal a
		where COALESCE(a.del_yn,'N') = 'N'
		and a.std_terms_prop_id =#{stdTermsPropId}
    </select>
    
    
    <select id="selectTblUseProposalDetail" resultType="dataSetModel" parameterType="dataSetCriteria">
		select a.data_set_typ_cd 
		        ,a.prop_title 
		         ,(select array_to_string(array_agg(s1.code_nm), ',') 
		                  from t_tbl_use_object s2
		                  left outer join t_code s1
		                  on s1.code_id =s2.use_obj_cd 
		                 where s2.tbl_use_prop_id = a.tbl_use_prop_id) as use_obj_nm
		        ,a.use_obj_detail 
		        ,a.info_prop_cd 
		        ,(select s1.code_nm from t_code s1 where s1.group_id='INFO_PROP_CD' and s1.code_id= a.info_prop_cd) as info_prop_nm 
		        ,a.use_after_info_proc 
		        ,a.use_term_sdt 
		        ,a.use_term_edt 
		        ,a.use_term_reason 
		        ,a.use_method 
		        ,b.spt_grp_cd
				,(select s1.code_nm from t_code s1 where s1.group_id='SPT_GRP_CD' and s1.code_id= b.spt_grp_cd) as spt_grp_nm
				,b.biz_div_cd
				,(select s1.code_nm  from t_code s1 where s1.group_id='BIZ_DIV_CD' and s1.code_id= b.biz_div_cd) as biz_div_nm
				,b.lvl_div_cd
				,(select s1.code_nm  from t_code s1 where s1.group_id='LVL_DIV_CD' and s1.code_id= b.lvl_div_cd) as lvl_div_nm
				,b.spt_cyc_cd
				,(select s1.code_nm  from t_code s1 where s1.group_id='SPT_CYC_CD' and s1.code_id= b.spt_cyc_cd) as spt_cyc_nm
				,B.spt_comp_cd
				,(select s1.code_nm  from t_code s1 where s1.group_id='SPT_COMP_CD' and s1.code_id= b.spt_comp_cd) as spt_comp_nm
				,b.tbl_kor
				,b.tbl_eng
				,(select array_to_string(array_agg(s1.tag_nm), ',')
									from t_hash_tag s1
									where s1.tbl_info_id = b.tbl_info_id 
									and COALESCE(s1.del_yn,'N') = 'N'
									)  as hash_tag_nm
				,b.use_prop_cnt
				,b.tbl_view_cnt
				,a.first_appr_id 
		        ,(select s2.user_nm  from t_user s2 where s2.user_id = a.first_appr_id) as first_appr_nm
		        ,a.second_appr_id 
		        ,(select s2.user_nm  from t_user s2 where s2.user_id = a.second_appr_id) as second_appr_nm
		        ,a.drafter_id 
		        ,(select s2.user_nm  from t_user s2 where s2.user_id = a.drafter_id) as drafter_nm
		from t_tbl_use_proposal a
		left outer join t_table_info b 
		on a.tbl_info_id = b.tbl_info_id 
		where COALESCE(a.del_yn,'N') = 'N'
		and a.tbl_use_prop_id = #{tblUsePropId}
    </select>
    
    <insert id="insertTableInfo" parameterType="dataSetModel">
    	insert into t_table_info(
				tbl_info_id				
				,data_div_cd
				,tbl_st_cd
				,spt_grp_cd
				,biz_div_cd
				,lvl_div_cd
				,spt_cyc_cd
				,spt_comp_cd
				,preserv_dt
				,db_typ
				,use_term_cd
				,spt_site_nm
				,spt_site_addr
				,tbl_kor
				,tbl_eng
				,tbl_desc
				,use_prop_cnt
				,tbl_view_cnt
				,del_yn
				,rgst_dt
				,rgst_id
				,modi_dt
				,modi_id
		)values(
				#{tblInfoId} 
				,#{dataDivCd}
				,#{tblStCd} 
				,#{sptGrpCd}
				,#{bizDivCd}
				,#{lvlDivCd}
				,#{sptCycCd}
				,#{sptCompCd}
				,#{preservDt}
				,#{dbTyp}
				,#{useTermCd}
				,#{sptSiteNm}
				,#{sptSiteAddr}
				,#{tblKor}
				,#{tblEng}
				,#{tblDesc}
				,#{usePropCnt}
				,#{tblViewCnt}
				,#{delYn}
				,now()
				,#{rgstId}
				,now()
				,#{modiId}
		)
    </insert>
   
    <update id="updateTableInfo" parameterType="dataSetModel">
    	update t_table_info set tbl_st_cd = #{tblStCd} 
									,spt_grp_cd = #{sptGrpCd}
									,biz_div_cd = #{bizDivCd}
									,lvl_div_cd = #{lvlDivCd}
									,spt_cyc_cd = #{sptCycCd}
									,spt_comp_cd = #{sptCompCd}
									,preserv_dt = #{preservDt}
									,db_typ=#{dbTyp}
									,use_term_cd = #{useTermCd}
									,spt_site_nm = #{sptSiteNm}
									,spt_site_addr = #{sptSiteAddr}
									,tbl_kor = #{tblKor}
									,tbl_eng = #{tblEng}
									,tbl_desc = #{tblDesc}
									,use_prop_cnt = #{usePropCnt}
									,tbl_view_cnt = #{tblViewCnt}
									,modi_dt = now()
									,modi_id = #{modiId}
		where 	tbl_info_id = #{tblInfoId} 
		and data_div_cd = #{dataDivCd}							
    </update>
    
    <update id="deleteTableInfo" parameterType="dataSetModel">
	    update t_table_info set del_yn = #{delYn}
										,modi_dt = now()
										,modi_id = #{modiId}
			where 	tbl_info_id = #{tblInfoId} 
			and data_div_cd = #{dataDivCd}			
    </update>
	
	<insert id="insertColumnInfo" parameterType="dataSetModel">
		insert into t_column_info(
					tbl_info_id
					,tbl_id
					,col_id
					,col_nm
					,col_ord
					,key_div_cd
					,pk_yn
					,data_typ_nm
					,com_cd
					,col_desc
					,del_yn
					,rgst_dt
					,rgst_id
					,modi_dt
					,modi_id
			)values(
					#{colInfoId}
					,#{tblInfoId}
					,#{colId}
					,#{colNm}
					,#{colOrd}
					,#{keyDivCd}
					,#{pkYn}
					,#{dataTypNm}
					,#{comCd}
					,#{colDesc}
					,#{delYn}
					,now()
					,#{rgstId}
					,now()
					,#{modiId}
			)
	</insert>
	
	<update id="updateColumnInfo" parameterType="dataSetModel">
	update t_column_info set col_id = #{colId}
										,col_nm = #{colNm}
										,col_ord = #{colOrd}
										,key_div_cd=#{keyDivCd}
										,pk_yn=#{pkYn}
										,data_typ_nm=#{dataTypNm}
										,com_cd=#{comCd}
										,col_desc=#{colDesc}
										,modi_dt = now()
										,modi_id = #{modiId}
		where col_info_id = #{colInfoId}
		and tbl_info_id= #{tblInfoId}			
	</update>
	
	<update id="deleteColumnInfo" parameterType="dataSetModel">
		update t_column_info set del_yn = #{delYn}
									,modi_dt = now()
									,modi_id = #{modiId}
		where col_info_id = #{colInfoId}
		and tbl_info_id= #{tblInfoId}	
	</update>
	
	<select id="selectHashTagList" resultType="dataSetModel" parameterType="dataSetCriteria">
		SELECT
			  HASH_TAG_ID
			, TAG_NM
			, RGST_ID
		FROM
			T_HASH_TAG
		WHERE
			TBL_INFO_ID = #{tblInfoId}
			AND DEL_YN = 'N'
		ORDER BY RGST_DT
	</select>

	<insert id="insertHashTag" parameterType="dataSetModel">
		insert into t_hash_tag(
					hash_tag_id
					,tbl_info_id
					,tag_nm
					,del_yn
					,rgst_dt
					,rgst_id
					,modi_dt
					,modi_id
			)values(
					#{hashTagId}
					,#{tblInfoId}
					,#{tagNm}
					,#{delYn}
					,now()
					,#{rgstId}
					,now()
					,#{modiId}
			)
	</insert>
	
	<update id="updateHashTag" parameterType="dataSetModel">
		update t_hash_tag set tag_nm = #{tagNm}
		                             ,modi_dt = now()
									,modi_id = #{modiId}
		where hash_tag_id = #{hashTagId}
		and tbl_info_id = #{tblInfoId}
	</update>
	
	<update id="deleteHashTag" parameterType="dataSetModel">
		update t_hash_tag set del_yn = #{delYn}
										 ,modi_dt = now()
										,modi_id = #{modiId}
			where hash_tag_id = #{hashTagId}
			and tbl_info_id = #{tblInfoId}
	</update>
	
	<insert id="insertDataComCode" parameterType="dataSetModel">
		insert into t_data_com_code(
			data_com_cd_id
			,grp_comp_cd
			,tbl_eng_nm
			,tbl_kor_nm
			,col_eng_nm
			,col_kor_nm
			,valid_val
			,valid_nm
			,del_yn
			,rgst_dt
			,rgst_id
			,modi_dt
			,modi_id
		)values(
			#{dataComCdId}
			,#{grpCompCd}
			,#{tblEngNm}
			,#{tblKorNm}
			,#{colEngNm}
			,#{colKorNm}
			,#{validVal}
			,#{validNm}
			,#{delYn}
			,now()
			,#{rgstId}
			,now()
			,#{modiId}
		)
	</insert>
	
	<update id="updateDataComCode" parameterType="dataSetModel">
		update t_data_com_code set grp_comp_cd = #{grpCompCd}
											,tbl_eng_nm = #{tblEngNm}
											,tbl_kor_nm = #{tblKorNm}
											,col_eng_nm = #{colEngNm}
											,col_kor_nm = #{colKorNm}
											,valid_val = #{validVal}
											,valid_nm = #{validNm}
											,modi_dt = now()
											,modi_id = #{modiId}
		where data_com_cd_id =#{dataComCdId}
	</update>
	
	<update id="deleteDataComCode" parameterType="dataSetModel">
		update t_data_com_code set del_yn = #{delYn}
												 ,modi_dt = now()
												,modi_id = #{modiId}
			where data_com_cd_id =#{dataComCdId	
	</update>
	
	<insert id="insertStandardTermsProposal" parameterType="dataSetModel">
		insert into t_standard_terms_proposal(
					std_terms_prop_id
					,grp_comp_cd
					,terms_nm
					,terms_eng
					,terms_abb
					,prop_id
					,detail_desc
					,view_cnt
					,appr_st_cd
					,first_appr_id
					,second_appr_id
					,drafter_id
					,del_yn
					,rgst_dt
					,rgst_id
					,modi_dt
					,modi_id
			)values(
					#{stdTermsPropId}
					,#{grpCompCd}
					,#{termsNm}
					,#{termsEng}
					,#{termsAbb}
					,#{propId}
					,#{detailDesc}
					,#{viewCnt}
					,#{apprStCd}
					,#{firstApprId}
					,#{secondApprId}
					,#{drafterId}
					,#{delYn}
					,now()
					,#{rgstId}
					,now()
					,#{modiId}
			)
	</insert>
	
	<update id="updateStandardTermsProposal" parameterType="dataSetModel">
		update t_standard_terms_proposal set grp_comp_cd = #{grpCompCd} 
		                                                ,terms_nm = #{termsNm}
														,terms_eng = #{termsEng}
														,terms_abb = #{termsAbb}
														,prop_id = #{propId}
														,detail_desc = #{detailDesc}
														,view_cnt = #{viewCnt}
														,appr_st_cd = #{apprStCd}
														,first_appr_id = #{firstApprId}
														,second_appr_id = #{secondApprId}
														,drafter_id = #{drafterId}
														,modi_dt = now()
														,modi_id = #{modiId}
		where std_terms_prop_id = #{stdTermsPropId}
	</update>
	
	<update id="deleteStandardTermsProposal" parameterType="dataSetModel">
		update t_standard_terms_proposal set del_yn = #{delYn}
											 ,modi_dt = now()
											,modi_id = #{modiId}
		where std_terms_prop_id = #{stdTermsPropId}
	</update>
	
	<insert id="insertTblUseProposal" parameterType="dataSetModel">
		insert into t_tbl_use_proposal(
					tbl_use_prop_id
					,tbl_info_id
					,data_set_typ_cd
					,prop_title
					,use_obj_detail
					,info_obj_cd
					,use_after_info_proc
					,use_term_sdt
					,use_term_edt
					,use_term_reason
					,use_method
					,appr_st_cd
					,first_appr_id
					,second_appr_id
					,drafter_id
					,del_yn
					,rgst_dt
					,rgst_id
					,modi_dt
					,modi_id
		)values(
					#{tblUsePropId}
					,#{tblInfoId}
					,#{dataSetTypCd}
					,#{propTitle}
					,#{useObjDetail}
					,#{infoPropCd}
					,#{useAfterInfoProc}
					,#{useTermSdt}
					,#{useTermEdt}
					,#{useTermReason}
					,#{useMethod}
					,#{apprStCd}
					,#{firstApprId}
					,#{secondApprId}
					,#{drafterId}
					,#{delYn}
					,now()
					,#{rgstId}
					,now()
					,#{modiId}
		)
	</insert>
	
	<update id="updateTblUseProposal" parameterType="dataSetModel">
		update t_tbl_use_proposal set data_set_typ_cd = #{dataSetTypCd}
												,prop_title = #{propTitle}
												,use_obj_detail = #{useObjDetail}
												,info_obj_cd = #{infoPropCd}
												,use_after_info_proc = #{useAfterInfoProc}
												,use_term_sdt = #{useTermSdt}
												,use_term_edt = #{useTermEdt}
												,use_term_reason = #{useTermReason}
												,use_method = #{useMethod}
												,appr_st_cd = #{apprStCd}
												,first_appr_id= #{firstApprId}
												,second_appr_id = #{secondApprId}
												,drafter_id = #{drafterId}
												,modi_dt = now()
												,modi_id = #{modiId}
			where tbl_use_prop_id = #{tblUsePropId}
			and tbl_info_id = #{tblInfoId}
	</update>
	
	<update id="deleteTblUseProposal" parameterType="dataSetModel">
		update t_tbl_use_proposal set del_yn = #{delYn}
											 ,modi_dt = now()
											,modi_id = #{modiId} 
		where tbl_use_prop_id = #{tblUsePropId}
		and tbl_info_id = #{tblInfoId}
	</update>
	
	<insert id="insertTblUseObject" parameterType="dataSetModel">
		insert into t_tbl_use_object(
						tbl_use_obj_id
						,tbl_use_prop_id
						,use_obj_cd
						,del_yn
						,rgst_dt
						,rgst_id
						,modi_dt
						,modi_id
			)values(
						#{tblUseObjId}
						,#{tblUsePropId}
						,#{useObjCd}
						,#{delYn}
						,now()
						,#{rgstId}
						,now()
						,#{modiId}
			)
	</insert>
	
	<update id="updateTblUseObject" parameterType="dataSetModel">
		update t_tbl_use_object set tbl_use_prop_id =#{tblUsePropId}
												,use_obj_cd = #{useObjCd}
												 ,modi_dt = now()
												,modi_id = #{modiId} 
		where tbl_use_obj_id =#{tblUseObjId}
	</update>
	
	<update id="deleteTblUseObject" parameterType="dataSetModel">
			update t_tbl_use_object set del_yn = #{delYn}
												 ,modi_dt = now()
												,modi_id = #{modiId} 
			where tbl_use_obj_id =#{tblUseObjId}
	</update>
	
</mapper>